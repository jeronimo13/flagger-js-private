{"version":3,"file":"flagger.cjs.js","sources":["../src/core/Store.js","../src/core/Flagger.js","../src/logger.js","../src/Flagger.js","../src/index.js"],"sourcesContent":["export default class Store {\n  constructor() {\n    // do stuff\n    console.log('stuff done')\n\n    // Empty store\n    this.store = {}\n  }\n\n  get(key) {\n    if (key in this.store) {\n      return this.store[key]\n    } else {\n      throw new Error(`Key ${key} not in store`)\n    }\n  }\n\n  setGatingInfo(gatingInfo) {\n    const flagMap = this._getFlagMap(gatingInfo)\n    this.store['flags'] = flagMap\n\n    // Send signal?\n  }\n\n  // PRIVATE API\n\n  _getFlagMap(gatingInfo) {\n    const map = {}\n\n    const flags = gatingInfo.flags\n\n    for (let i = 0; i < flags.length; i++) {\n      const flag = Object.assign({}, flags[i])\n      if (flag.flagType === 'uncategorized' || flag.flagStatus === 'archived') {\n        map[flag.codename] = new Flag(flag)\n        continue\n      }\n\n      const overrides = flag.overrides\n      const overridesMap = {}\n\n      for (let j = 0; j < overrides.length; j++) {\n        const override = overrides[j]\n\n        overridesMap[`${override.entityType}_${override.entityId}`] = override\n      }\n\n      flag.overrides = overridesMap\n\n      const treatments = flag.treatments\n      const treatmentsMap = {}\n      let offTreatment = null\n\n      for (let k = 0; k < treatments.length; k++) {\n        const treatment = treatments[k]\n\n        treatmentsMap[treatment.treatmentId] = treatment\n\n        if (treatment.isOffTreatment) {\n          offTreatment = treatment\n        }\n      }\n\n      flag.treatments = treatments\n      flag.treatmentsMap = treatmentsMap\n      flag.offTreatment = offTreatment\n\n      map[flag.codename] = new Flag(flag)\n    }\n\n    return map\n  }\n\n}\n","import Store from './Store'\n\nexport default class Flagger {\n  // Public API\n\n  constructor() {\n    // Variable holding whether configuration is done\n    this.configurationComplete = false\n\n    // Instantiate an instance of Store\n    this.store = new Store()\n  }\n\n  configure(flagConfig) {\n    // Set this in store\n\n  }\n\n  flag(flagName) {\n    // returns a flag\n  }\n\n  shutdown() {\n\n  }\n\n  publish(entities) {\n\n  }\n\n  identify(entity) {\n\n  }\n}\n","const LEVELS = ['debug', 'log', 'info', 'error']\n\nexport default class Logger {}\n\nLEVELS.forEach(level => {\n  Logger.prototype[level] = (logCallArgs) => {\n    console.log.apply(null, logCallArgs)\n  }\n})\n","// Builtins and externals\nimport axios from 'axios'\n\n// Internals\nimport FlaggerCore from './core/Flagger'\nimport Logger from './logger'\n\nconst logger = new Logger()\n\nexport default class Flagger extends FlaggerCore {\n\n  // Public API\n\n\tconstructor() {\n    super()\n\n\t\tconst initVar = 'test'\n\t\tconsole.log('inited')\n    logger.log('inited with logger')\n\n    axios.get('/')\n      .then((response) => {\n        console.log('response')\n      })\n      .catch((error) => {\n        console.log('error')\n      })\n\n    // subscribes to configuration complete signal / set configured compelte bool to true\n  }\n\n\techo(phrase) {\n\t\tconsole.log(phrase)\n\t}\n\n  configure(options) {\n    // SEND_SIGNAL: Start configuration...\n  }\n\n  flag(flagName) {\n    // returns a flag\n  }\n\n  shutdown() {\n\n  }\n\n  publish(entities) {\n\n  }\n\n  identify(entity) {\n\n  }\n}\n","import Flagger from './Flagger'\n\nconst _flagger = new Flagger()\n\nexport default _flagger\n"],"names":["Store","constructor","console","log","store","get","key","Error","setGatingInfo","gatingInfo","flagMap","_getFlagMap","map","flags","i","length","flag","Object","assign","flagType","flagStatus","codename","Flag","overrides","overridesMap","j","override","entityType","entityId","treatments","treatmentsMap","offTreatment","k","treatment","treatmentId","isOffTreatment","Flagger","configurationComplete","configure","flagConfig","flagName","shutdown","publish","entities","identify","entity","LEVELS","Logger","forEach","level","prototype","logCallArgs","apply","logger","FlaggerCore","axios","then","response","catch","error","echo","phrase","options","_flagger"],"mappings":";;;;;;AAAe,MAAMA,KAAN,CAAY;EACzBC,WAAW,GAAG;;IAEZC,OAAO,CAACC,GAAR,CAAY,YAAZ,EAFY;;SAKPC,KAAL,GAAa,EAAb;;;EAGFC,GAAG,CAACC,GAAD,EAAM;QACHA,GAAG,IAAI,KAAKF,KAAhB,EAAuB;aACd,KAAKA,KAAL,CAAWE,GAAX,CAAP;KADF,MAEO;YACC,IAAIC,KAAJ,CAAW,OAAMD,GAAI,eAArB,CAAN;;;;EAIJE,aAAa,CAACC,UAAD,EAAa;UAClBC,OAAO,GAAG,KAAKC,WAAL,CAAiBF,UAAjB,CAAhB;;SACKL,KAAL,CAAW,OAAX,IAAsBM,OAAtB,CAFwB;GAjBD;;;EA0BzBC,WAAW,CAACF,UAAD,EAAa;UAChBG,GAAG,GAAG,EAAZ;UAEMC,KAAK,GAAGJ,UAAU,CAACI,KAAzB;;SAEK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGD,KAAK,CAACE,MAA1B,EAAkCD,CAAC,EAAnC,EAAuC;YAC/BE,IAAI,GAAGC,MAAM,CAACC,MAAP,CAAc,EAAd,EAAkBL,KAAK,CAACC,CAAD,CAAvB,CAAb;;UACIE,IAAI,CAACG,QAAL,KAAkB,eAAlB,IAAqCH,IAAI,CAACI,UAAL,KAAoB,UAA7D,EAAyE;QACvER,GAAG,CAACI,IAAI,CAACK,QAAN,CAAH,GAAqB,IAAIC,IAAJ,CAASN,IAAT,CAArB;;;;YAIIO,SAAS,GAAGP,IAAI,CAACO,SAAvB;YACMC,YAAY,GAAG,EAArB;;WAEK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGF,SAAS,CAACR,MAA9B,EAAsCU,CAAC,EAAvC,EAA2C;cACnCC,QAAQ,GAAGH,SAAS,CAACE,CAAD,CAA1B;QAEAD,YAAY,CAAE,GAAEE,QAAQ,CAACC,UAAW,IAAGD,QAAQ,CAACE,QAAS,EAA7C,CAAZ,GAA8DF,QAA9D;;;MAGFV,IAAI,CAACO,SAAL,GAAiBC,YAAjB;YAEMK,UAAU,GAAGb,IAAI,CAACa,UAAxB;YACMC,aAAa,GAAG,EAAtB;UACIC,YAAY,GAAG,IAAnB;;WAEK,IAAIC,CAAC,GAAG,CAAb,EAAgBA,CAAC,GAAGH,UAAU,CAACd,MAA/B,EAAuCiB,CAAC,EAAxC,EAA4C;cACpCC,SAAS,GAAGJ,UAAU,CAACG,CAAD,CAA5B;QAEAF,aAAa,CAACG,SAAS,CAACC,WAAX,CAAb,GAAuCD,SAAvC;;YAEIA,SAAS,CAACE,cAAd,EAA8B;UAC5BJ,YAAY,GAAGE,SAAf;;;;MAIJjB,IAAI,CAACa,UAAL,GAAkBA,UAAlB;MACAb,IAAI,CAACc,aAAL,GAAqBA,aAArB;MACAd,IAAI,CAACe,YAAL,GAAoBA,YAApB;MAEAnB,GAAG,CAACI,IAAI,CAACK,QAAN,CAAH,GAAqB,IAAIC,IAAJ,CAASN,IAAT,CAArB;;;WAGKJ,GAAP;;;;;ACpEW,MAAMwB,OAAN,CAAc;;EAG3BnC,WAAW,GAAG;;SAEPoC,qBAAL,GAA6B,KAA7B,CAFY;;SAKPjC,KAAL,GAAa,IAAIJ,KAAJ,EAAb;;;EAGFsC,SAAS,CAACC,UAAD,EAAa;;;EAKtBvB,IAAI,CAACwB,QAAD,EAAW;;;EAIfC,QAAQ,GAAG;;EAIXC,OAAO,CAACC,QAAD,EAAW;;EAIlBC,QAAQ,CAACC,MAAD,EAAS;;;;AC9BnB,MAAMC,MAAM,GAAG,CAAC,OAAD,EAAU,KAAV,EAAiB,MAAjB,EAAyB,OAAzB,CAAf;AAEA,AAAe,MAAMC,MAAN,CAAa;AAE5BD,MAAM,CAACE,OAAP,CAAeC,KAAK,IAAI;EACtBF,MAAM,CAACG,SAAP,CAAiBD,KAAjB,IAA2BE,WAAD,IAAiB;IACzCjD,OAAO,CAACC,GAAR,CAAYiD,KAAZ,CAAkB,IAAlB,EAAwBD,WAAxB;GADF;CADF;;ACJA;AACA,AAMA,MAAME,MAAM,GAAG,IAAIN,MAAJ,EAAf;AAEA,AAAe,MAAMX,SAAN,SAAsBkB,OAAtB,CAAkC;;EAIhDrD,WAAW,GAAG;;AAGb,AACAC,IAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;IACEkD,MAAM,CAAClD,GAAP,CAAW,oBAAX;IAEAoD,KAAK,CAAClD,GAAN,CAAU,GAAV,EACGmD,IADH,CACSC,QAAD,IAAc;MAClBvD,OAAO,CAACC,GAAR,CAAY,UAAZ;KAFJ,EAIGuD,KAJH,CAIUC,KAAD,IAAW;MAChBzD,OAAO,CAACC,GAAR,CAAY,OAAZ;KALJ,EAPW;;;EAkBdyD,IAAI,CAACC,MAAD,EAAS;IACZ3D,OAAO,CAACC,GAAR,CAAY0D,MAAZ;;;EAGAvB,SAAS,CAACwB,OAAD,EAAU;;;EAInB9C,IAAI,CAACwB,QAAD,EAAW;;;EAIfC,QAAQ,GAAG;;EAIXC,OAAO,CAACC,QAAD,EAAW;;EAIlBC,QAAQ,CAACC,MAAD,EAAS;;;;ACjDnB,MAAMkB,QAAQ,GAAG,IAAI3B,SAAJ,EAAjB;;;;"}